```
Задача 6 — TOCTOU (time-of-check-to-time-of-use) при файлови операции
Идея: Проверяваш “безопасност” (напр. os.path.islink) и после пишеш → между проверка и запис атакуващият подменя целта.
Уязвимост: Разчитане на две отделни операции (check → use).
Експлойт: С бърз swap (symlink на POSIX, os.replace() трикове на Windows) насочваш записа към “лош” файл.
Поправка:
    • Отваряне с флагове, които елиминират TOCTOU, напр. os.open(path, O_CREAT|O_WRONLY|O_TRUNC|O_NOFOLLOW) и после os.fdopen.
    • Без отделна проверка; rely на атомичност.
Приемни критерии:
    • Тестът показва възможност за злоупотреба (или поне висок шанс) в vulnerable.
    • В fixed записът става винаги в желания файл.
Чести капани:
    • На Windows symlink-ите искат Developer Mode/админ. Затова тестът ползва fallback със os.replace().
    • Някои файлови системи се държат различно — затова тестът допуска retry/timeout.
Hints:
    • Hint 1: “Какво става между ‘check’ и ‘use’? Кой може да промени файловата система?”
    • Hint 2: “Има ли по-сигурен начин да отвориш файла ‘директно безопасно’?”
    • Hint 3: “Погледни os.open и наличните флагове.”
Разширение: Работа с директории; временни файлове с NamedTemporaryFile + атомично rename.
```